# Тесты для датчиков CAN

## Состояние
Перед запуском любых тестов приложение должно быть запущено
* Вручную, при помощи сценария __start_app.py__
* Автоматически по истечению таймаута, если это настроено в бутлоадере

## LSS
__*Тесты проверяющие повдения службы LSS в устройстве*__

### lss.py
pytest тестовый сценарий. Для проведения тестов необходимо установить
скорость can вручную
```
# ip link set <canX> up type can bitrate <speed> loopback off
```
Проводит следующие тесты
* Глобальное переключение режимов LSS
* Селективное переключение режимов LSS
* Переключение скорости CAN, без применения настроек
* Запрос идентификационных данных LSS
* Установка Canopen NODE ID

### canopen_lss_fastscan.py
python-скрипт, вызывающий процедуру LSS fast scan.
Возвращает идентификационные дынные НЕНАСТРОЕННОГО устройства с МЕНЬШИМ LSS идентификатором.

### lss.py
pytest тестовый сценарий проверяет
* Переключение LSS-режимов всей сети
* Переключение LSS-режимов конкретного устройства
* Переключение скоростей по LSS
* Чтение LSS id
* Установку nodeID
* Сохранение nodeID после подачи комманды RESET COMMUNICATION
* Переустановка nodeID после RESET COMMUNICATION

### lss_bitrates.py
pytest тестовый сценарий. Проверяет установку скорости обмена с загрузчиком.
Необходимо, чтобы загрузчик имел дефолтную скорость обмена **10000bps**

## NMT
__*Тесты проверяющие работу NMT*__

### nmt.py
pytest тестовый сценарий проверяет
* Сброс устройства по RESET COMMUNICATION и RESET
* Переход между режимами PRE-OPERATIONAL и OPERATIONAL
* Проверку блокировки настройки LSS в режиме OPERATIONAL
* Сброс скорости на дефолтную при команде RESET
* Сохранение настроек скорости после RESET COMMUNICATION
* Возврат в загрузчик и обратно при помощи состояния STOP

## SDO
__*Тесты проверяющие работу SDO*__

### sdo_read_all.py
pytest тестовый сценарий. Пытается читать все объекты Object dictionary
Примечание: `canopen.sdo.exceptions.SdoAbortedError` с кодом **0x06010001**
Ощибкой не считается.

### sdo.py
pytest тестовый сценарий, проверяет следующее:
* Ячейки, которые доступны только для чтения не могут быть записаны, возвращется код 0x06010002
* Ячейки для чтения и записи юзером пишутся и читаются.
* Ячейки защищиенные паролем не записываются если пароль установлен неверно, возращается код 0x06010000
* Значениея ячеек сохраняются, если их изменить и вызвать node.store(), что вызывает запись 1010sub1 <- 0x65766173 "save"

### Emergency.py
Сценарий, позволяющий отслеживать сообщения Emergency в сети can